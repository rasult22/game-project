<script>
  import { onMount } from "svelte";

  export let game_id;

  let init = true
  let inList = false
  let list = []

  onMount(() => {
    const items = localStorage.getItem('favorite_list')
    if (items) {
      let parsedList = JSON.parse(items)
      inList = parsedList.includes(game_id)
      list = [...parsedList]
    }
    init = false
  })

  const onAddList = () => {
    localStorage.setItem('favorite_list', JSON.stringify([...list, game_id]))
    inList = true
  }

  const onRemoveList = () => {
    const removedList = list.filter(item => item !== game_id)
    localStorage.setItem('favorite_list', JSON.stringify(removedList))
    inList = false
  }
</script>

{#if init}
  <div></div>
{:else if inList}
  <button
    on:click={onRemoveList}
    class="w-full mt-[10px] justify-center font-medium bg-[#272727] flex items-center space-x-2 text-white py-[10px] active:scale-95 active:bg-[#272727] transition-all px-[36px] rounded-[12px]"
    >
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path fill-rule="evenodd" clip-rule="evenodd" d="M8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6H18.9883C18.9953 5.99993 19.0024 5.99993 19.0095 6H20C20.5523 6 21 6.44772 21 7C21 7.55228 20.5523 8 20 8H19.9201L18.9997 19.0458C18.9878 19.8249 18.6731 20.5695 18.1213 21.1213C17.5587 21.6839 16.7957 22 16 22H8C7.20435 22 6.44129 21.6839 5.87868 21.1213C5.32687 20.5695 5.01223 19.8249 5.00035 19.0458L4.07987 8H4C3.44772 8 3 7.55228 3 7C3 6.44772 3.44772 6 4 6H4.99054C4.9976 5.99993 5.00466 5.99993 5.0117 6H8V4C8 3.46957 8.21071 2.96086 8.58579 2.58579ZM6.0868 8L6.99655 18.917C6.99885 18.9446 7 18.9723 7 19C7 19.2652 7.10536 19.5196 7.29289 19.7071C7.48043 19.8946 7.73478 20 8 20H16C16.2652 20 16.5196 19.8946 16.7071 19.7071C16.8946 19.5196 17 19.2652 17 19C17 18.9723 17.0012 18.9446 17.0035 18.917L17.9132 8H6.0868ZM14 6H10V4H14V6ZM10 10C10.5523 10 11 10.4477 11 11V17C11 17.5523 10.5523 18 10 18C9.44772 18 9 17.5523 9 17V11C9 10.4477 9.44772 10 10 10ZM14 10C14.5523 10 15 10.4477 15 11V17C15 17.5523 14.5523 18 14 18C13.4477 18 13 17.5523 13 17V11C13 10.4477 13.4477 10 14 10Z" fill="white"/>
    </svg>
    <span> Remove from list</span>
  </button>
{:else}
  <button
    on:click={onAddList}
    class="w-full mt-[10px] justify-center font-medium bg-[#272727] flex items-center space-x-2 text-white py-[10px] active:scale-95 active:bg-[#272727] transition-all px-[36px] rounded-[12px]"
    >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M8.41135 5.01115C7.86226 4.95258 7.30699 5.00833 6.78051 5.1749C6.25402 5.34146 5.76773 5.61524 5.35225 5.97898C4.93677 6.34272 4.6011 6.78854 4.36638 7.28838C4.13167 7.78822 4.00299 8.33124 3.98845 8.88326C3.97391 9.43527 4.07382 9.98432 4.2819 10.4958C4.48997 11.0073 4.8017 11.4702 5.19746 11.8553L5.20377 11.8615L5.20374 11.8615L12.0001 18.5926L18.7964 11.8615C18.8171 11.841 18.8385 11.8215 18.8605 11.8032C19.2242 11.4301 19.5117 10.9894 19.7066 10.5056C19.9123 9.99497 20.0104 9.4474 19.9948 8.89714C19.9791 8.34688 19.8501 7.80577 19.6157 7.30768C19.3813 6.8096 19.0466 6.36525 18.6326 6.00246C18.2185 5.63967 17.7341 5.36624 17.2095 5.19928C16.685 5.03233 16.1316 4.97544 15.5841 5.03219C15.0365 5.08893 14.5066 5.25808 14.0274 5.52905C13.5482 5.80003 13.1301 6.16699 12.7993 6.60697C12.6098 6.85898 12.3126 7.00687 11.9973 7.00599C11.682 7.00511 11.3855 6.85558 11.1975 6.60251C10.8681 6.15931 10.4505 5.78912 9.97096 5.51524C9.49146 5.24136 8.96044 5.06973 8.41135 5.01115ZM20.1347 13.3508L12.7037 20.7105C12.314 21.0965 11.6861 21.0965 11.2964 20.7105L3.79935 13.2855C3.20729 12.7084 2.74085 12.0153 2.42931 11.2494C2.1172 10.4822 1.96733 9.65862 1.98914 8.8306C2.01095 8.00257 2.20397 7.18804 2.55605 6.43828C2.90812 5.68852 3.41162 5.01978 4.03484 4.47417C4.65806 3.92856 5.3875 3.5179 6.17723 3.26805C6.96696 3.0182 7.79986 2.93458 8.6235 3.02244C9.44713 3.1103 10.2437 3.36774 10.9629 3.77856C11.337 3.99221 11.6859 4.24493 12.0042 4.5318C12.3221 4.2484 12.6702 3.99891 13.0429 3.78814C13.7617 3.38168 14.5566 3.12796 15.3779 3.04284C16.1992 2.95773 17.0293 3.04305 17.8161 3.29349C18.6029 3.54392 19.3296 3.95406 19.9507 4.49825C20.5717 5.04244 21.0737 5.70896 21.4253 6.45609C21.7769 7.20322 21.9705 8.01488 21.994 8.84027C22.0174 9.66566 21.8703 10.487 21.5618 11.2529C21.2532 12.0188 20.7899 12.7128 20.2008 13.2914C20.1794 13.3124 20.1574 13.3322 20.1347 13.3508Z"
        fill="white"></path>
    </svg>
    <span> Add to list</span>
  </button>
{/if}
